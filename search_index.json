[
["index.html", "R para jurimetria Capítulo 1 Apresentação", " R para jurimetria Associação Brasileira de Jurimetria 17 de January de 2018 Capítulo 1 Apresentação Olá! Bem vindo ao curso R para Jurimetria :) Essa é a primeira iteração do curso de R para Jurimetria da ABJ. Nesse curso abordamos aspectos práticos da Jurimetria, essenciais para um profissional da Estatística que tenha interesse em trabalhar nessa área. O curso é voltado para graduandos em estatística e está organizado em cinco aulas. (15/01) Introdução à jurimetria e setup Definição Terminologia Tipos de pesquisa e exemplos Ambientação com R e RStudio RMarkdown (17/01) Ferramentas da ABJ para importação Introdução ao web scraping com httr e rvest. Pacotes abjutils, esaj e dje. (19/01) Tidyverse: vetores Vetores: pacotes stringr, lubridate, forcats. Programação funcional: purrr. (22/01) Tidyverse: bd Transformação: pacotes dplyr, tidyr. Aplicação: Câmaras criminais. (24/01) Modelagem Especialização de varas: pacotes bnlearn e survival. Captchas: pacotes keras e decryptr. Para o curso, será necessário ter conhecimentos do software estatístico R, como a lógica de programação, sintaxe do R e ambientação com o RStudio. "],
["introducao.html", "Capítulo 2 Introdução", " Capítulo 2 Introdução Bem vinda ao maravilhoso mundo da jurimetria. Essa é sua última chance. Está preparada? "],
["o-que-e-jurimetria.html", "2.1 O que é Jurimetria?", " 2.1 O que é Jurimetria? A jurimetria é o estudo empírico do direito. Ela se distingue das demais disciplinas jurídicas por tratar o direito de forma concreta. A pesquisa em jurimetria utiliza dados do judiciário para avaliar desde argumentos quantitativos a serem utilizados por juristas e advogados até o impacto de leis. No Brasil, é utilizada principalmente como ferramenta para auxiliar na formulação de políticas públicas, melhorar a administração dos tribunais, calcular o risco de carteiras de processos e otimizar estratégias processuais. A jurimetria está para o Direito da mesma forma que a econometria, a biometria e a sociometria estão, respectivamente, para a Economia, Biologia e Sociologia. O Direito, embora conte com algumas áreas tradicionalmente mais empíricas que outras, ainda não tem uma disciplina mais formalizada. No mundo corporativo, a jurimetria está se tornando essencial para departamentos jurídicos de grandes empresas e escritórios de advocacia. O movimento da tecnologia no Direito ganhou ainda mais força no ano de 2017 com o advento da AB2L e das lawtechs, as startups do meio jurídico. Nesse sentido, uma das missões da Associação Brasileira de Jurimetria (ABJ) é incentivar e divulgar a jurimetria aos seus associados e ao público em geral. Nossos estudos e pesquisas visam a difusão e o desenvolvimento do campo no Brasil, agregando pesquisadores e fornecendo o ferramental necessário para realização das análises. Neste curso, apresentaremos o ferramental de trabalho desenvolvido no laboratório da ABJ. As ferramentas servem principalmente para extração e arrumação de dados, deixando o caminho livre para realização de análises estatísticas mais aprofundadas. "],
["tipos-de-estudo.html", "2.2 Tipos de estudo", " 2.2 Tipos de estudo No decorrer do curso trabalharemos dois tipos comuns de estudos jurimétricos: prospectivo e retrospectivo. É importante separar esses tipos de estudo tanto pela matéria desenvolvida quanto pelas fontes de dados disponíveis. Faremos isso através de um exemplo. 2.2.1 Exemplo Digamos que a NET tenha colocado seu nome indevidamente no Serasa e você processa ela. Quando você entra com um processo, ele é distribuído (levado) numa vara (casinha do juiz), por exemplo uma vara cível de São Carlos, e seu processo estará na 1a instância. O juiz então irá decidir sobre o caso, produzindo uma sentença (um texto de 5-10 páginas que explica o que ele decidiu e por quê). Se você ou a NET ficarem infelizes com o resultado, vocês podem entrar com um recurso de apelação (evolução de processo), que será distribuído numa câmara (evolução de vara) do Tribunal de Justiça de São Paulo (TJSP, que fica na praça da Sé, em São Paulo), a ser julgada por desembargadores (evolução de juiz), e seu processo estará na 2a instância. Os desembargadores então irão decidir sobre o caso, produzindo um acórdão (evolução de sentença). Se você ou a NET ficarem infelizes com o resultado, vocês podem novamente entrar com recursos, que irão para o STJ e posteriormente ao STF (em Brasília), a serem julgados por Ministros (evolução de desembargador). Nossos estudos restringem-se ao TJSP, envolvendo (1) e (2). O TJSP atualmente é o mais simples para obtenção automática de processos. 2.2.2 Divisão regional O TJSP é dividido em comarcas, circunscrições e regiões administrativas. As comarcas são conjuntos de um ou mais municípios e uma comarca deve sempre ter uma ou mais varas. Circunscrições e regiões administrativas existem somente para 2.2.3 Qual tipo escolher? Estudo prospectivo é o estudo que acompanha o processo judicial desde a data de distribuição até o fim. O fim pode ser marcado pela data da sentença, acórdão, ou outro evento de interesse. Ou seja, os casos são indexados pela data de nascimento, e acompanhados até a data de sua morte. Em muitos casos, os processos ainda não atingiram o fim no momento da realização do estudo. Estudo retrospectivo é o estudo que levanta processos que acabaram (por sentença ou por acórdão) e analisa suas características. Ou seja, os casos são indexados pela data de morte. A Figura abaixo mostra os diferentes escopos. ( 1) Prospectivo e retrospectivo. ( 2) Apenas prospectivo. ( 3) Apenas retrospectivo. ( 4) Nenhum dos dois, mas poderia ser capturado por atividade no período. (5 e 6) fora do escopo. ( 7) Nenhum dos dois tipos e não poderia ser capturado (ficou inativo no período). Estudos prospectivos são úteis quando o intuito é estudar o tempo das fases do processo. Já estudos retrospectivos são úteis para a análise do perfil de decisões. Estudos que analisam tempos em bases retrospectivas. Se quiser saber mais sobre isso, veja esse texto. "],
["estudo-1-camaras-criminais.html", "2.3 Estudo 1: Câmaras criminais", " 2.3 Estudo 1: Câmaras criminais O Direito Criminal é uma área que traz consigo diversas questões difíceis e importantes da nossa sociedade. Uma destas questões, que remete ao possível descolamento da teoria do Direito e o que ocorre no mundo real, trata do cumprimento da pena. Considerando-se o plano ideal e o princípio de ampla defesa, mas também a conhecida morosidade dos tribunais, qual é o momento do processo em que deveria ser iniciado o cumprimento de pena? Será que a taxa de reforma das decisões é tão pequena a ponto de justificar o início do cumprimento de pena após a sentença na primeira instância? Com o objetivo de obter essas taxas, a presente pesquisa utiliza como base de dados um levantamento de 157.379 decisões em segunda instância, das quais 57.625 envolvem apelações contra o Ministério Público, todas proferidas entre 01/01/2014 e 31/12/2014 nas dezesseis Câmaras de Direito Criminal do Estado de São Paulo, e nas quatro Câmaras Extraordinárias. A Figura 2.1 mostra a distribuição dos resultados dos processos em relação aos órgãos julgadores. Aqui, encontramos discrepâncias enormes, onde podemos encontrar câmaras com mais de 75% de recursos negados (quarta e sexta) e câmaras com menos de 30% de recursos negados (primeira, segunda e décima segunda). Este resultado poderia ser explicado por duas hipóteses: os processos não são distribuídos aleatoriamente nas câmaras, e é feita uma triagem que envolve o tipo do recurso; ou os magistrados de cada câmara comportam-se de maneiras muito diferentes, mesmo para processos considerados homogêneos. Figura 2.1: Resultados por câmara. "],
["estudo-2-especializacao-de-varas-empresariais.html", "2.4 Estudo 2: Especialização de varas empresariais", " 2.4 Estudo 2: Especialização de varas empresariais 2.4.1 Contextualização Apesar do município de São Paulo ser o maior polo empresarial do Brasil, a comarca de São Paulo não possuía varas especializadas nessa matéria. Por outro lado, o provimento nº 82/2011 do TJSP define critérios para criação de varas: Uma vara só pode ser criada se o volume de trabalho esperado for maior do que 1.800 processos/ano. A análise deve levar em conta a complexidade dos feitos. Em levantamentos anteriores, foram observadas menos de 1.800 distribuições de processos em um ano e, portanto, não seria possível justificar a criação dessas varas. No entanto, é sabido que processos empresariais, em média, são mais complexos que processos cíveis. Por isso, faria sentido criar varas empresariais, ainda que a meta quantitativa não fosse atingida. Como verificar essa hipótese? Nesse estudo, buscamos formas de comparar a complexidade processos cíveis e empresariais. 2.4.2 Desafio adicional: cifra oculta Em estudos jurimétricos, até mesmo a pergunta “quantos processos empresariais são distribuídos por ano na comarca de São Paulo?” é complicada. Os registros são imprecisos e a classificação proposta pelo CNJ não é bem utilizada. Atualmente, a forma mais direta de identificar tipos de processos judiciais é utilizando os chamados assuntos processuais. Os assuntos relacionam-se com as matérias discutidas em cada caso. Por exemplo, um caso cível de indenização por dano moral poderia ter um assunto “Indenização por dano moral”, enquanto um processo falimentar de uma empresa em Recuperação Judicial poderia ser classificado como “Convocação de Recuperação Judicial em Falência”. Nesse contexto, um importante passo foi dado com a Resolução 46/2007 do CNJ1, que criou as TPUs. As TPUs são uma documentação oficial de todas as classes, assuntos e movimentações dos processos. As TPUs foram implantadas em todas as Justiças, o que facilita a realização de análises que comparam diferentes tribunais. A Figura ?? mostra uma parte das TPUs do CNJ. As TPUs são estruturadas em formato de árvore. Isso significa que temos assuntos genéricos e assuntos específicos, sendo que o assunto específico é um filho do assunto genérico. As TPUs podem ter até seis níveis hierárquicos de assuntos. O problema enfrentado atualmente é que, na prática, nem sempre os processos são classificados com assuntos específicos. Assim, podemos ter um caso que discute sobre “Análise de Crédito” classificado como “Responsabilidade do Fornecedor”, ou ainda “Direito do Consumidor”. A existência de casos classificados com assuntos genéricos implica num problema para o levantamento do volume processual por assunto. Por exemplo, considere que há interesse em conhecer o volume de processos envolvendo “Análise de Crédito”. Se considerarmos somente os casos classificados corretamente, estaríamos subestimando o real volume de processos, pois estaríamos ignorando os casos classificados em assuntos genéricos. Por outro lado, se considerarmos no levantamento todos os casos, incluindo os genéricos, estaríamos superestimanto o real volume. A possibilidade de subestimação do volume real de processos de um certo tipo configura o que chamamos de cifra oculta. Dado um assunto específico, esse número pode ser definido como a quantidade de processos com esse assunto, mas classificados em assuntos genéricos. Felizmente, a cifra oculta pode ser estimada. Para isso, no entanto, é necessário fazer algumas suposições ou utilizar conhecimentos a priori sobre os processos. A forma mais simples de estimar a cifra oculta é realizando uma espécie de regra de três. No exemplo da análise de crédito, considere que temos uma base de dados com todos os casos classificados com assuntos dentro da árvore do “Direito do Consumidor”. Suponha também que todos os processos de análise de crédito foram classificados ou corretamente, ou incorretamente como “Direito do Consumidor”. Utilizando somente a parte da base que foi classificada com assuntos específicos, estimamos a proporção de casos \\(p\\) classificados como “Análise de Crédito”. Assim, uma estimativa do volume de processos de análise de crédito é dada por \\[ N_{\\text{cred}}=N_A+N_T\\times p, \\text{onde} \\] \\(N_A\\) é o volume de casos classificados corretamente como “Análise de Crédito”. \\(N_T\\) é o volume total de casos classificados como “Direito do Consumidor”. \\(N_T\\times p\\) é a estimativa da cifra oculta. Na nossa aplicação, isso foi feito estimando-se a probabilidade de um assunto genérico tratar da matéria empresarial, usando-se uma rede bayesiana. Para esse cálculo, utilizamos a parcela da base de dados que foi classificada corretamente e calculamos a proporção de processos empresariais para cada assunto. A cifra oculta é estimada somando-se as probabilidades obtidas. Nossos dados originais são: No Foro Central Cível foram distribuídos 675 processos empresariais por ano. Nos demais Foros foram distribuídos 450 processos por ano. Total: 1.125 processos/ano. Aplicando as correções, temos: No Foro Central Cível foram distribuídos 961 processos empresariais/ano. Nos demais Foros foram distribuídos 641 processos empresariais/ano. Total: 1.602 processos/ano. 2.4.3 Voltando à complexidade Agora vamos fazer comparações. O processo demora mais tempo como um todo? \\[ \\text{Complexidade} = \\text{Tempo entre distribuicao e sentenca} \\] O processo custa mais tempo aos magistrados? \\[ \\text{Complexidade} = \\text{Tempo entre conclusos e decisoes} \\] Nas duas métricas, processos empresariais são mais complexos. Comparando casos de dificuldade moderada, processos empresariais custam o dobro de tempo para magistrados e 30% a mais de tempo na tramitação total. Aplicando os critérios propostos, a carga de trabalho proporcionada pelos processos empresariais corresponde a - 2.082 processos comuns, considerando o custo em tramitação; - 3.349 processos comuns, considerando o tempo gasto pelos magistrados. http://www.cnj.jus.br/images/stories/docs_cnj/resolucao/rescnj_46.pdf. Acesso em 26/06/2017.↩ "],
["estudo-3-captchas.html", "2.5 Estudo 3: CAPTCHAs", " 2.5 Estudo 3: CAPTCHAs Apesar dos sistemas jurídicos serem públicos, seus dados não são acessíveis. Muitas vezes o acesso às páginas web são limitadas através de bloqueios de IP e Algumas justificativas para a existência de CAPTCHAs são: i) não onerar os sistemas ou ii) a ideia de que assim estão protegendo as pessoas. O primeiro argumento é frágil pois ambos poderiam ser resolvidos através de uma API de acesso público dos tribunais, ou mesmo uma API paga. O segundo argumento também é ruim, pois, ainda que limitado, esses dados serão obtidos e utilizados. Limitar o acesso só aumenta o custo para construção dessas bases, direcionando o poder para as empresas que têm mais dinheiro para investir nisso, causando viés no acesso à informação. Fazendo curta uma história longa, se um dado é público, ele deve ser acessível. Nos trabalhos da ABJ, esbarramos com CAPTCHAs inúmeras vezes. Recentemente, descobrimos formas de resolver CAPTCHAs automaticamente utilizando modelos estatísticos. Esses modelos são da recente (ou não) classe de modelos de deep learning, uma área que cresceu exponencialmente nos últimos anos. Incluímos esse exemplo no curso por dois motivos. Apesar de não ser um modelo jurimétrico, trata-se de um problema presente no contexto da jurimetria, logo é um conhecimento útil. Além disso, a técnica utilizada para quebrar CAPTCHAs é muito interessante e poderia ser adaptada para diversos contextos, inclusive estudos jurimétricos. Nossas soluções para quebrar captchas foram consolidadas num pacote chamado decryptr. Vamos discutir brevemente como ele foi criado e como usar. Também discutiremos superficialmente o modelo de redes neurais utilizado e como criar o seu próprio modelo. Veja um quebrador de captcha em funcionamento: "],
["cuidado.html", "2.6 Cuidado", " 2.6 Cuidado As bases de dados utilizadas em estudos jurimétricos foram originalmente concebidas para fins gerenciais e não analíticos. Por isso, observamos muitos dados faltantes, mal formatados e com documentação inadequada. Uma boa porção dos dados só está disponível em páginas HTML e arquivos PDF e grande parte da informação útil está escondida em textos. Chamamos esse fenômeno de “pré-sal sociológico”. Temos hoje diversas bases de dados armazenadas em repositórios públicos ou controladas pelo poder público, mas que precisam ser lapidadas para obtenção de informação útil. O jurimetrista trabalha com dados sujos e desorganizados, mas gera muito valor ao extrair suas informações. Por isso, o profissional precisa dominar o ferramental de extração, transformação e visualização de dados, e é sobre isso que discutiremos na primeira parte do curso. Utilizaremos como base o software estatístico R, que atualmente possui diversas ferramentas que ajudam nessas atividades. "],
["organizacao-do-curso.html", "2.7 Organização do curso", " 2.7 Organização do curso O curso foi montado em RMarkdown, usando um pacote chamado bookdown. O material é 100% reprodutível e está disseminado em diversos lugares no GitHub. As aulas foram organizadas pelo Ciclo de ciência de dados. Trabalharemos com o tidyverse Import: esaj e dje. Tidy / Transform: abjutils, dplyr, stringr, lubridate, forcats, tidyr e purrr. Visualize: ggplot2. Model: survival, bnlearn, keras "],
["configuracao-necessaria-para-o-curso.html", "2.8 Configuração necessária para o curso", " 2.8 Configuração necessária para o curso 2.8.1 Pacotes Para poder rodar os códigos do curso, é importante que você instale todos os pacotes relacionados a este livro. Para isso, basta rodar devtools::install_github(&quot;abjur/r4jurimetrics&quot;) Esse código teoricamente funciona pois este livro também é um pacote e adicionamos todas as dependências. Se você não conseguir instalar as dependências, abra o arquivo DESCRIPTION do material: https://github.com/abjur/r4jurimetrics/blob/master/DESCRIPTION Nesse aquivo constam todos os pacotes que estamos utilizando. Se algo deu errado na instalação do r4jurimetrics, é porquê pelo menos um desses pacotes deu erro na instalação. Note que os pacotes dentro de Remotes devem ser instalados com devtools::install_github(). Note também que os pacotes que estão no Remotes também estão no Imports. 2.8.2 Fork e upstream (experimental) Para fazer essa parte funcionar, você precisará de uma conta ativa no GitHub. Se você não tiver uma, recomendamos fortemente que criem. Agora siga os passos abaixo: Acesse no seu navegador: https://github.com/abjur/r4jurimetrics Certifique-se de que você está logado na sua conta. Dê um fork no repositório Volte ao RStudio Crie um projeto: Projetos &gt; New Project &gt; Version control &gt; git Na parte do link do repositório, coloque https://github.com//r4jurimetrics Dê OK e certifique-se de que o repositório foi criado. Abra um terminal: Tools &gt; Shell Arrume e rode git config --global user.email &quot;seuEmail&quot; e git config --global user.name &quot;seuLogin&quot; Esses comandos configuram seu usuário para registrar mudanças nos repositórios. Rode git remote add upstream https://github.com/abjur/r4jurimetrics.git Esse comando faz com que seu repositório fique ligado ao repositório original Rode git fetch upstream Esse comando baixa as atualizações do repositório pai, se houverem Rode git merge upstream/master -m &quot;merge with parent&quot; Esse comando juntar o seu repositório com o código do reporitório pai. Nesse momento podem acontecer conflitos. Se tiver algum problema, veja: https://help.github.com/articles/configuring-a-remote-for-a-fork/ https://help.github.com/articles/syncing-a-fork/ "],
["suas-tarefas-para-1701-demora-30-min.html", "2.9 Suas tarefas para 17/01 (demora 30 min)", " 2.9 Suas tarefas para 17/01 (demora 30 min) Entrar no grupo: t.me/rbrasil Cadastrar na newsletter da ABJ http://www.abj.org.br Ler blog: http://www.abj.org.br/blog/2017/01/27/2017-01-28-assuntos/ Ler blog: http://www.abj.org.br/blog/2016/12/31/2016-12-31-tempos/ Dar uma olhada em https://abjur.github.io/tjspBook Dar uma olhada em http://material.curso-r.com Dar uma olhada em https://tidyverse.org Dar uma olhada em http://r4ds.had.co.nz Dar uma olhada em https://github.com/abjur, https://github.com/courtsbr, https://github.com/curso-r "],
["importacao-de-dados.html", "Capítulo 3 Importação de dados", " Capítulo 3 Importação de dados Agora nós estamos aqui: Nessa parte, vamos aprender a baixar dados da web. No contexto da jurimetria, isso é muito importante por dois motivos: i) você nunca pode esperar que alguém ofereça esses dados organizados para você e ii) isso é muito divertido e é um aprendizado para a vida. 3.0.1 Setup Logar no servidor http://r.abj.org.br Novo projeto &gt; Version Control &gt; GIT Colocar a URL https://github.com/abjur/r4jurimetrics Iniciar projeto Abrir o arquivo 02-import.Rmd Rodar library(tidyverse) "],
["pipe.html", "3.1 Pipe %&gt;%", " 3.1 Pipe %&gt;% Considere o seguinte exemplo: f &lt;- function(x, y) x + y x &lt;- 1 y &lt;- 2 As duas linhas abaixo são equivalentes: f(x, y) #&gt; [1] 3 x %&gt;% f(y) #&gt; [1] 3 Exemplo: alcular raiz quadrada da soma dos valores de 1 a 4. x &lt;- c(1, 2, 3, 4) x %&gt;% sum() %&gt;% sqrt() #&gt; [1] 3.162278 Escrever esse cálculo na forma usual ficaria da seguinte forma: sqrt(sum(x)) #&gt; [1] 3.162278 3.1.1 Receita de bolo Tente entender o que é preciso fazer. esfrie( asse( coloque( bata( acrescente( recipiente(rep(&quot;farinha&quot;, 2), &quot;água&quot;, &quot;fermento&quot;, &quot;leite&quot;, &quot;óleo&quot;), &quot;farinha&quot;, até = &quot;macio&quot;), duração = &quot;3min&quot;), lugar = &quot;forma&quot;, tipo = &quot;grande&quot;, untada = TRUE), duração = &quot;50min&quot;), &quot;geladeira&quot;, &quot;20min&quot;) Desistiu? Agora veja como fica escrevendo com o %&gt;%: recipiente(rep(&quot;farinha&quot;, 2), &quot;água&quot;, &quot;fermento&quot;, &quot;leite&quot;, &quot;óleo&quot;) %&gt;% acrescente(&quot;farinha&quot;, até = &quot;macio&quot;) %&gt;% bata(duraço = &quot;3min&quot;) %&gt;% coloque(lugar = &quot;forma&quot;, tipo = &quot;grande&quot;, untada = TRUE) %&gt;% asse(duração = &quot;50min&quot;) %&gt;% esfrie(&quot;geladeira&quot;, &quot;20min&quot;) Agora o código realmente parece uma receita de bolo. Para mais informações sobre o pipe e exemplos de utilização, visite a página Ceci n’est pas un pipe. "],
["usando-o-inspect.html", "3.2 Usando o Inspect", " 3.2 Usando o Inspect Se você quer aprender a baixar dados da web, você precisa aprender a usar o Inspect do seu navegador. Para isso, vamos abrir a página do e-SAJ. Agora clique com o botão direito e depois em “inspecionar” (vamos assumir que você está usando o Google Chrome). Na tela que vai abrir, entre na aba “Network”. O navegador vai pedir que você atualize a página, apertando F5. Faça isso. Agora você verá uma lista de documentos que seu navegador baixou para carregar a página. O primeiro item dessa lista, consultaCompleta.do, contém informações da sua consulta processual. Clique nesse item. O conteúdo dessa página é a requisição web utilizada para acessar o e-SAJ. Basicamente, tudo o que faremos na parte de web scraping é tentar imitar o que esse site faz. Tenha em mente que, para construir um scraper, você usará duas ferramentas principais: seu navegador e o RStudio. "],
["pacotes-httr-xml2-e-rvest.html", "3.3 Pacotes httr, xml2 e rvest", " 3.3 Pacotes httr, xml2 e rvest Esses são os três pacotes mais modernos do R para fazer web scraping. O pacote xml2 tem a finalidade de estruturar arquivos HTML ou XML de forma eficiente, tornando possível a obtenção de tags e seus atributos dentro de um arquivo. Já o pacote httr é responsável por realizar requisições web para obtenção das páginas de interesse, buscando reduzir ao máximo a complexidade da programação. O pacote rvest é escrito sobre os dois anteriores e por isso eleva ainda mais o nível de especialização para raspagem de dados. A utilização dos pacotes tem uma regra de bolso. Para trabalhar com páginas simples, basta carregar o rvest e utilizar suas funcionalidades. Caso o acesso à página exija ações mais complexas e/ou artifícios de ferramentas web, será necessário utilizar o httr. O xml2 só será usado explicitamente nos casos em que a página está em XML. Esses pacotes não são suficientes para acessar todo tipo de conteúdo da web. Um exemplo claro disso são páginas em que o conteúdo é produzido por javascript, o que acontece em alguns sites modernos. Para trabalhar com esses sites, é necessário realmente “simular” um navegador que acessa a página web. Uma das melhores ferramentas para isso é o selenium. Não discutiremos selenium nesse curso, mas caso queira se aprofundar, acesse aqui e o pacote RSelenium. 3.3.1 GET e POST Uma requisição GET envia uma url ao servidor, possivelmente com alguns parâmetros nessa url (que ficam no final da url depois do ?). O servidor, por sua vez, recebe essa url, processa os parâmetros e retorna uma página HTML para o navegador2. A requisição POST, no entanto, envia uma url não modificada para o servidor, mas envia também uma lista de dados preenchidos pelo usuário, que podem ser números, textos ou até imagens. Na maioria dos casos, ao submeter um formulário de um site, fazemos uma requisição POST. O httr possui os métodos GET e POST implementados e são muito similares. A lista de parâmetros enviados pelo usuário pode ser armazenado numa list nomeada, e adicionado ao GET pelo parâmetro query ou no POST pelo parâmetro body. Exemplo de GET httr::GET(&quot;http://google.com/search&quot;, query = list(q = &quot;jurimetria&quot;)) #&gt; Response [http://www.google.com/search?q=jurimetria] #&gt; Date: 2018-01-17 10:14 #&gt; Status: 200 #&gt; Content-Type: text/html; charset=ISO-8859-1 #&gt; Size: 41.2 kB #&gt; &lt;!doctype html&gt;&lt;html itemscope=&quot;&quot; itemtype=&quot;http://schema.org/SearchResu... #&gt; statistics, to law. The subject has gained considerable currency in both... #&gt; States and Brazil. In the United States, the journal Jurimetrics is publ... #&gt; American Bar Association and Arizona State University. In Brazil, the fi... #&gt; focus&amp;nbsp;...&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;g&quot;&gt;&lt;h3 class=&quot;r&quot;&gt;&lt;a hre... #&gt; no Direito. Índice. [esconder]. 1 Histórico; 2 Os Três Prismas da &lt;b&gt;Jur... #&gt; Elaboração Legislativa e Gestão Pública; 2.2 A Decisão Judicial; 2.3 A I... #&gt; Probatória. 3 &lt;b&gt;Jurimetria&lt;/b&gt; vs Law and Economics; 4 Referências; 5 L... #&gt; bem como tece considerações e sugestões relevantes de aplicações prática... #&gt; teóricas do tema. É proposta a divisão da &lt;b&gt;jurimetria&lt;/b&gt; em três pris... #&gt; ... Exemplo de POST httr::POST(&quot;http://httpbin.org/post&quot;, body = list(x = &quot;Mãe to na request&quot;), encode = &quot;json&quot;) #&gt; Response [http://httpbin.org/post] #&gt; Date: 2018-01-17 10:14 #&gt; Status: 200 #&gt; Content-Type: application/json #&gt; Size: 528 B #&gt; { #&gt; &quot;args&quot;: {}, #&gt; &quot;data&quot;: &quot;{\\&quot;x\\&quot;:\\&quot;M\\u00e3e to na request\\&quot;}&quot;, #&gt; &quot;files&quot;: {}, #&gt; &quot;form&quot;: {}, #&gt; &quot;headers&quot;: { #&gt; &quot;Accept&quot;: &quot;application/json, text/xml, application/xml, */*&quot;, #&gt; &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, #&gt; &quot;Connection&quot;: &quot;close&quot;, #&gt; &quot;Content-Length&quot;: &quot;26&quot;, #&gt; ... 3.3.2 Exercícios Use o Inspect: Qual o método usado na pesquisa de jurisprudência do TJSP? Qual o método usado na busca avançada de diários de justiça do TJSP? 3.3.3 Sessões e cookies No momento que acessamos uma página web, o navegador baixa alguns arquivos que identificam nosso acesso à página. Esses arquivos são chamados cookies e são usados pelos sites para realizar diversas atividades, como carregar uma página pré-definida pelo usuário caso este acesse o site pela segunda vez ou fazer propagandas. O httr e o rvest já guardam esses cookies de forma automática, de forma que o usuário não precise sa preocupar com isso. Em casos raros, para construir o web scraper é necessário modificar esses cookies. Nesses casos, estude a função cookies() do httr. 3.3.4 Outras funções do httr Outras funções úteis: write_disk() para escrever uma requisição direto em disco, além de guardar na memória RAM. config() para adicionar configurações adicionais. Por exemplo, quando acessar uma página https com certificados inadequados numa requisição GET, rode GET('https://www...', config(ssl_verifypeer = FALSE)). oauth_app() para trabalhar com APIs. Não discutiremos conexão com APIs nesse curso, mas é um importante conceito a ser estudado. 3.3.5 Principais funções do rvest Para acessar páginas da web: html_session() abre uma sessão do usuário (baixa página, carrega cookies etc). follow_link(), jump_to() acessa uma página web a partir de um link (tag &lt;a&gt;) ou url. html_form() carrega todos os formulários contidos numa página. set_value() atribui valores a parâmetros do formulário. submit_form() submete um formulário obtido em html_form. Para trabalhar com arquivos HTML: read_html() lê o arquivo HTML de forma estruturada e facilita impressão. html_nodes() cria uma lista com os nós identificados por uma busca em CSS path ou XPath. html_node() é um caso especial que assume que só será encontrado um resultado. html_text() extrai todo o conteúdo de um objeto e retorna um texto. html_table() extrai o conteúdo de uma &lt;table&gt; e transforma em um data_frame. html_attr() extrai um atributo de uma tag, por exemplo href da tag &lt;a&gt;. Se quiser ver exemplos, entre em http://material.curso-r.com/scrape/ 3.3.6 CSS path e XPath O CSS path e o XPath são formas distintas de buscar tags dentro de um documento HTML. O CSS path é mais simples de implementar e tem uma sintaxe menos verborrágica, mas o XPath é mais poderoso. A regra de bolso é tentar fazer a seleção primeiro em CSS e, caso não seja possível, implementar em XPath. Esses paths serão mostrados en passant durante o curso, mas não serão abordados em detalhe. Caso queira se aprofundar no assunto, comece pela ajuda da função ?html_nodes. para entender sobre server side e user side, acesse server side e user side.↩ "],
["melhores-praticas-para-web-scraping.html", "3.4 Melhores práticas para web scraping", " 3.4 Melhores práticas para web scraping É importante ressaltar que só estamos trabalhando com dados públicos. Caso tenha interesse em raspar páginas que precisam de autenticação ou uma página .com, recomendamos que estude os termos de uso do site. Nessa parte, trabalharemos principalmente com a Consulta de Jurisprudência e a Consulta de de Processos de Segundo Grau do TJSP, mas também teremos um pouco de pesquisas nos diários oficiais. 3.4.1 Informações iniciais Antes de iniciar um scraper, verifique se existe alguma forma mais fácil de conseguir os dados que necessita. Construir um web scraper do zero é muitas vezes uma tarefa dolorosa e, caso o site seja atualizado, pode ser que boa parte do trabalho seja inútil. Se os dados precisarem ser extraídos apenas uma vez, verifique com os responsáveis pela manutenção do site se eles podem fazer a extração que precisa. Se os dados precisarem ser atualizados, verifique se a entidade não possui uma API para acesso aos dados. Ao escrever um web scraper, as primeiras coisas que devemos pensar são, nessa porgem Qual o caminho percorrido para acessar uma página específica. Como o site a ser acessado foi contruído, se tem limites de requisições, utilização de cookies, states, etc. Como e com que frequência o site é atualizado, tanto em relação à sua interface como em relação aos dados que queremos extrair. Em sites dos tribunais, uma boa prática é dividir as atividades em três grupos principais: i) listar; ii) coletar e iii) processar. Quando já sabemos de antemão quais são os processos que vamos acessar, a etapa de listagem é desnecessária. Deixamos os algoritmos de coleta e processamento dos dados em funções distintas para aumentar o controle sobre o que as ferramentas estão fazendo. Isso facilita o debug e a atualização. Por outro lado, em alguns casos isso pode tornar o código ineficiente e os dados brutos obtidos podem ficar pesados. "],
["listando-processos.html", "3.5 Listando processos", " 3.5 Listando processos A forma de listar processos muda se seu estudo é prospectivo ou retrospectivo. Se o estudo for prospectivo, precisamos baixar dados dos Diários de Justiça Eletrônicos (DJE), que são arquivos PDF enormes. Se o estudo for retrospectivo, precisamos baixar dados da Consulta de Julgados de Segundo Grau (CJSG), que é um formulário na internet, mais simples. Se o seu estudo é retrospectivo, use esaj::download_cjsg(). CJSG significa Consulta de Julgados de Segundo Grau. Se o seu estudo é prospectivo, usedje::download_dje(). DJE significa Diário de Justiça Eletrônico "],
["usando-o-esaj-para-listar-processos.html", "3.6 Usando o esaj para listar processos", " 3.6 Usando o esaj para listar processos A CJSG possui vários parâmetros para consulta de decisões. As mais usadas são Palavras-chave Classe, assunto e câmaras Intervalos de datas 3.6.1 Pesquisa por palavras-chave A pesquisa por palavras-chave não tem segredo. Basta você seguir as especificações deste link. É importante ressaltar alguns pontos O e-SAJ não disponibiliza seu tesauro publicamente. Ou seja, você terá de confiar na pesquisa por sinônimos. Você não pode fazer uma busca completamente vazia. Ou você coloca a palavra-chave, ou você especifica outro parâmetro Você pode pesquisar o termo a OU (NAO a), se quiser ;) 3.6.2 Pesquisa por datas Você pode usar duas datas para indexar os processos de sua pesquisa. A data de registro é a data em que o serventuário inclui a decisão no sistema. A data de julgamento é a data em que o conjunto de desembargadores proferiram a decisão. Normalmente, a indexação aconteceria pela data de julgamento, já que queremos vincular os processos à sua data final, não em relação à uma data do sistema. No entanto, as pesquisas indexadas pela data de julgamento não são completamente reprodutíveis, já que à medida que o tempo passa, mais decisões são registradas, mudando a base de julgados. Regra de bolso: Use data de registro se quiser ter certeza de que você pegou todos os casos em um determinado intervalo de tempo. Use data de julgamento se você estiver pesquisando casos mais antigos (por exemplo, de 2016 para trás), já que a quantidade de decisões não registradas nesse escopo é negligenciável. 3.6.3 Tabelas de classes, assuntos e câmaras Classes e assuntos definem, respectivamente, os ritos processuais e os tipos processuais. As câmaras são as casinhas dos desembargadores, que podem ser ordinárias (fixas) ou extraordinárias (eventuais, criadas por diferentes motivos). As classes e assuntos são definidas em formato de árvore. Cada nível dessa árvore tem uma lista de classes/assuntos e seus respectivos códigos. As tabelas de classes/assuntos podem ser obtidas pela função esaj::cjsg_table(). # Não rode esses códigos. Eles baixam os dados diretos da web classes &lt;- esaj::cjsg_table(&quot;classes&quot;) assuntos &lt;- esaj::cjsg_table(&quot;subjects&quot;) Já baixamos essas tabelas e colocamos em arquivos .rds (você sabe o que é um arquivo .rds?) assuntos &lt;- readRDS(&quot;data/cjsg_assuntos.rds&quot;) classes &lt;- readRDS(&quot;data/cjsg_classes.rds&quot;) glimpse(assuntos) #&gt; Observations: 3,088 #&gt; Variables: 12 #&gt; $ name0 &lt;chr&gt; &quot;0 - Assunto não Especificado&quot;, &quot;14 - DIREITO TRIBUTÁRIO... #&gt; $ id0 &lt;chr&gt; &quot;0&quot;, &quot;14&quot;, &quot;14&quot;, &quot;14&quot;, &quot;14&quot;, &quot;14&quot;, &quot;14&quot;, &quot;14&quot;, &quot;14&quot;, &quot;14... #&gt; $ name1 &lt;chr&gt; NA, &quot;5913 - Limitações ao Poder de Tributar&quot;, &quot;5913 - Li... #&gt; $ id1 &lt;chr&gt; NA, &quot;5913&quot;, &quot;5913&quot;, &quot;5913&quot;, &quot;5913&quot;, &quot;5913&quot;, &quot;5913&quot;, &quot;591... #&gt; $ name2 &lt;chr&gt; NA, &quot;5914 - Imunidade&quot;, &quot;5914 - Imunidade&quot;, &quot;5914 - Imun... #&gt; $ id2 &lt;chr&gt; NA, &quot;5914&quot;, &quot;5914&quot;, &quot;5914&quot;, &quot;5914&quot;, NA, NA, NA, NA, NA, ... #&gt; $ name3 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ... #&gt; $ id3 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ... #&gt; $ name4 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ... #&gt; $ id4 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ... #&gt; $ name5 &lt;chr&gt; &quot;0 - Assunto não Especificado&quot;, &quot;10527 - Livros / Jornai... #&gt; $ id5 &lt;chr&gt; &quot;0&quot;, &quot;10527&quot;, &quot;10528&quot;, &quot;10529&quot;, &quot;10530&quot;, &quot;5915&quot;, &quot;10540&quot;... Na prática, você vai procurar os assuntos que quer nessa tabela, obter os respectivos códigos e guardar em um vetor. Cuidado: Lembre-se da cifra oculta! Além disso, muitos casos têm assunto vazio. A tabela de câmaras segue a mesma regra. A única diferença é que não existem níveis, logo você só precisará procurar os nomes em uma coluna camaras &lt;- esaj::cjsg_table(&quot;courts&quot;) camaras &lt;- readRDS(&quot;data/cjsg_camaras.rds&quot;) glimpse(camaras) #&gt; Observations: 1,208 #&gt; Variables: 3 #&gt; $ branch &lt;chr&gt; &quot;DIREITO PÚBLICO&quot;, &quot;DIREITO PÚBLICO&quot;, &quot;DIREITO PÚBLICO&quot;... #&gt; $ court &lt;chr&gt; &quot;1.ª Câmara Direito Público B&quot;, &quot;1.º Grupo Direito Públ... #&gt; $ id &lt;chr&gt; &quot;0-434&quot;, &quot;0-438&quot;, &quot;0-439&quot;, &quot;0-57&quot;, &quot;0-209&quot;, &quot;0-1202&quot;, &quot;... 3.6.4 A função download_cjsg Com o escopo em mãos, podemos finalmente começar a baixar dados. Esses são os argumentos da função esaj::download_cjsg(). Veja a documentação ?esaj::download_cjsg args(esaj::download_cjsg) #&gt; function (query, path = &quot;.&quot;, classes = &quot;&quot;, subjects = &quot;&quot;, courts = &quot;&quot;, #&gt; trial_start = &quot;&quot;, trial_end = &quot;&quot;, registration_start = &quot;&quot;, #&gt; registration_end = &quot;&quot;, min_page = 1, max_page = 1, cores = 1, #&gt; wait = 0.5, tj = &quot;tjsp&quot;) #&gt; NULL Esse código baixa duas páginas da pesquisa de jurisprudência usando a palavra-chave homicídio, salvando os arquivos HTML na pasta data-raw/cjsg esaj::download_cjsg(&quot;homicídio&quot;, &quot;data-raw/cjsg&quot;, max_page = 2) Onde guardar os dados? Ao construir um scraper, é importante guardar os dados brutos na máquina ou num servidor, para reprodutibilidade e manutenção do scraper. Se estiver construindo um pacote do R, o melhor lugar para guardar esses dados é na pasta data-raw, como sugerido no livro r-pkgs. Se os dados forem muito volumosos, pode ser necessário colocar esses documentos numa pasta externa ao pacote. 3.6.5 Exercícios Faça o download das páginas 2 à 5 de uma pesquisa com palavra-chave igual ao seu nome. Descubra quantos resultados tem a sua pesquisa usando a função esaj::peek_cjsg(). 3.6.6 Arrumando os dados Para transformar os arquivos HTML em bases de dados prontas para análise, você precisa rodar esaj::parse_cjsg(). files &lt;- dir(&quot;data-raw/cjsg&quot;, full.names = TRUE, pattern = &quot;page&quot;) d_cjsg &lt;- esaj::parse_cjsg(files) glimpse(d_cjsg) #&gt; Observations: 40 #&gt; Variables: 13 #&gt; $ file &lt;chr&gt; &quot;data-raw/cjsg/page1.html&quot;, &quot;data-raw/cjsg/pag... #&gt; $ id_page &lt;chr&gt; &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;... #&gt; $ id_decision &lt;chr&gt; &quot;11103571&quot;, &quot;11103186&quot;, &quot;11103116&quot;, &quot;11102507&quot;... #&gt; $ id_lawsuit &lt;chr&gt; &quot;2234431-52.2017.8.26.0000&quot;, &quot;2243740-97.2017.... #&gt; $ class_subject &lt;chr&gt; &quot;Classe/Assunto:\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t Habea... #&gt; $ district &lt;chr&gt; &quot;São Paulo&quot;, &quot;Olímpia&quot;, &quot;Mongaguá&quot;, &quot;Pirajuí&quot;,... #&gt; $ court &lt;chr&gt; &quot;6ª Câmara de Direito Criminal&quot;, &quot;6ª Câmara de... #&gt; $ dt_decision &lt;chr&gt; &quot;11/01/2018&quot;, &quot;11/01/2018&quot;, &quot;14/12/2017&quot;, &quot;11/... #&gt; $ dt_publication &lt;chr&gt; &quot;12/01/2018&quot;, &quot;12/01/2018&quot;, &quot;12/01/2018&quot;, &quot;11/... #&gt; $ dt_registration &lt;chr&gt; &quot;12/01/2018&quot;, &quot;12/01/2018&quot;, &quot;12/01/2018&quot;, &quot;11/... #&gt; $ rapporteur &lt;chr&gt; &quot;Ricardo Tucunduva&quot;, &quot;Ricardo Tucunduva&quot;, &quot;Ama... #&gt; $ summary &lt;chr&gt; NA, NA, &quot;TRÁFICO DE DROGAS – recurso do minis... #&gt; $ txt_summary &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA... 3.6.7 Exercícios Na pesquisa que você fez, qual é a comarca de origem mais frequente? Qual a diferença entre summary e txt_summary? "],
["usando-o-dje-para-listar-processos.html", "3.7 Usando o dje para listar processos", " 3.7 Usando o dje para listar processos O pacote dje baixa e lê diários de justiça eletrônicos. Com ele é possível baixar os PDFs e arrumá-los para obter uma base semi-estruturada. A função dje::download_dje() baixa os diários referentes a um dia. No TJSP, temos seis cadernos do diário, que são salvos em arquivos separados: 11: Judicial - 2a instância 12: Judicial - 1a instância - capital 18: Judicial - 1a instância - interior parte 1 13: Judicial - 1a instância - interior parte 2 15: Judicial - 1a instância - interior parte 3 14: Editais e Leilões dje::download_dje(&quot;TJSP&quot;, dates = &quot;2018-01-12&quot;, path = &quot;data-raw/dje&quot;) 3.7.1 Exercício O que acontece quando você tenta baixar um DJE de um dia num final de semana ou feriado? 3.7.2 Parse DJE Para parsear o DJE, primeiro você precisa transformar os PDF em textos: dje::dje_to_text(&quot;data-raw/dje/tjsp_dje_2018-01-12&quot;) E depois você aplica a função dje::parse_dje_tjsp() para ler os textos # para pegar somente 1a instancia patterns &lt;- glue::glue(&quot;_{c(12, 13, 15, 18)}_&quot;) %&gt;% glue::collapse(&quot;|&quot;) #arquivos dje_files &lt;- dir(&quot;data-raw/dje/tjsp_dje_2018-01-12_txt&quot;, full.names = TRUE, pattern = patterns) # veremos purrr nas próximas aulas! d_dje &lt;- purrr::map_dfr(dje_files, dje::parse_dje_tjsp) glimpse(d_dje) #&gt; Observations: 11,799 #&gt; Variables: 3 #&gt; $ classe &lt;chr&gt; &quot;\\nFórum João Mendes Júnior\\n&quot;, &quot;\\nFórum João Mendes... #&gt; $ valor &lt;chr&gt; &quot;\\nDistribuidor Cível\\n&quot;, &quot;\\nDistribuidor Cível\\n&quot;, ... #&gt; $ processos &lt;chr&gt; &quot;\\nDistribuidor Cível\\nRELAÇÃO DOS FEITOS CÍVEIS DIS... "],
["baixando-documentos.html", "3.8 Baixando documentos", " 3.8 Baixando documentos Baixar documentos, no entando, significa simplesmente acessar pesquisas de processos individuais e salvá-las em disco. Em algumas situações, os documentos baixados (depois de limpos) podem conter uma nova lista de documentos a serem baixadas, formando iterações de coletas. A tarefa de baixar documentos pré-estabelecidos será realizada pelas funções esaj::download_cposg(), esaj::download_cpopg() e esaj::download_decision(). 3.8.1 Download CPOSG As funções de download de processos recebem um vetor de números e baixam um HTML para cada deles. Às vezes um número de processo corresponde a mais do que um documento. Nesse caso, ambos os documentos são baixados, adicionando-se identificação de data. processos &lt;- unique(d_cjsg$id_lawsuit) esaj::download_cposg(processos, &quot;data-raw/cposg&quot;) 3.8.2 Baixando decisões Se o seu estudo é retrospectivo, você também pode baixar as decisões (sentenças ou acórdãos) do processo, em PDF. O código a ser rodado nesse caso é acordaos &lt;- d_cjsg$id_decision esaj::download_decision(acordaos) Por trás da função esaj::download_decision() estamos quebrando um CAPTCHA. Essa função ainda está instável, então pode ser necessário rodá-la várias vezes para obter os documentos finais. "],
["processando-documentos.html", "3.9 Processando documentos", " 3.9 Processando documentos Finalmente, processar documentos significa carregar dados acessíveis em disco e transformar os dados brutos uma base tidy. Usualmente separamos a estruturação em duas etapas: i) transformar arquivos não-estruturados em um arquivos semi-estruturados (e.g. um arquivo HTML em uma tabela mais um conjunto de textos livres) e ii) transformar arquivos semi-estruturados em uma base analítica (estruturada). A tarefa de processar as páginas HTML será realizada pelas funções esaj::parse_cjsg() e esaj::run_parser(). 3.9.1 Parse CPOSG O parser da consulta de processos foi escrito de um jeito especial. Uma página de resultados tem vários blocos de informações, entre eles i) dados básicos, ii) partes, iii) movimentações e iv) decisões. Em algumas pesquisas, temos interesse em apenas uma parte desses blocos. O parser foi construído para modular essa captura de informações. Outra diferença importante é que, nesse caso, salvamos individualmente os resultados do parse em arquivos .rds. Isso é feito para evitar retrabalho, já que esse processo é computacionalmente intensivo e o algoritmo pode travar no meio da execução. # lista de arquivos files_cposg &lt;- dir(&quot;data-raw/cposg&quot;, full.names = TRUE) # objeto de parse parser &lt;- esaj::make_parser() %&gt;% esaj::parse_data() %&gt;% esaj::parse_parts() %&gt;% esaj::parse_movs() %&gt;% esaj::parse_decisions() # rodar parse d_cposg &lt;- esaj::run_parser(file = files_cposg, parser = parser, path = &quot;data-raw/cposg_rds&quot;) Para obter a base de dados, basta ler e empilhar os arquivos parciais que foram gerados. rds_files &lt;- dir(&quot;data-raw/cposg_rds&quot;, full.names = TRUE) d_cposg &lt;- purrr::map_dfr(rds_files, readRDS) glimpse(d_cposg) #&gt; Observations: 41 #&gt; Variables: 7 #&gt; $ id &lt;chr&gt; &quot;00000091520158260558&quot;, &quot;00003442220148260347&quot;, &quot;000... #&gt; $ file &lt;chr&gt; &quot;data-raw/cposg/00000091520158260558.html&quot;, &quot;data-ra... #&gt; $ hidden &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL... #&gt; $ data &lt;list&gt; [&lt;# A tibble: 13 x 2, data value ... #&gt; $ parts &lt;list&gt; [&lt;# A tibble: 3 x 4, id name ... #&gt; $ movs &lt;list&gt; [&lt;# A tibble: 23 x 2, movement description ... #&gt; $ decisions &lt;list&gt; [&lt;# A tibble: 1 x 2, date decision ... 3.9.2 Exercícios Estude o objeto d_cposg. O que temos na coluna data? E na coluna parts? Qual é o outro parâmetro da função esaj::run_parser(), e o que ele faz? OBS: Os objetos data, parts, movs e decisions do d_cposg são chamados de list columns. "],
["pacote-abjutils.html", "3.10 Pacote abjutils", " 3.10 Pacote abjutils 3.10.1 Trabalhando com números de processos O número identificador de um processo judicial utilizado atualmente pelos tribunais é chamado número CNJ, criado na Resolução 65 do CNJ. A resolução define o padrão NNNNNNN-DD.AAAA.J.TR.OOOO, descrito abaixo. NNNNNNN: Número identificador do processo. DD: Dígito verificador gerado a partir da aplicação do algoritmo Módulo 97 Base 10, conforme Norma ISO 7064:2003. AAAA: Ano do ajuizamento do processo. J: Segmento do poder judiciário. No nosso caso, esse número é sempre 8, que identifica a Justiça Estadual. TR: Identifica o tribunal. No nosso caso, esse número é sempre 26 (TJSP). OOOO: Identifica a unidade de origem do processo. No nosso caso, as possíveis configurações identificam os foros de São Paulo. Na maioria dos casos, o número também identifica a comarca, pois existem poucas comarcas com mais de um foro (e.g. a comarca de São Paulo, que possui mais de dez foros regionais). id_montado &lt;- &quot;0000009-15.2015.8.26.0558&quot; id_limpo_dig &lt;- &quot;00000091520158260558&quot; id_limpo_ndig &lt;- &quot;000000920158260558&quot; As funções abjutils::build_id() e abjutils::clean_id() montam ou limpam o número do processo. abjutils::build_id(id_limpo_dig) #&gt; [1] &quot;0000009-15.2015.8.26.0558&quot; abjutils::clean_id(id_montado) #&gt; [1] &quot;00000091520158260558&quot; A função abjutils::extract_parts() extrai todos os componentes do número do processo. abjutils::extract_parts(id_montado) #&gt; [[1]] #&gt; N D A J T O #&gt; &quot;0000009&quot; &quot;15&quot; &quot;2015&quot; &quot;8&quot; &quot;26&quot; &quot;0558&quot; A função abjutils::separate_cnj() faz o mesmo, mas em uma coluna do banco de dados d_cjsg %&gt;% abjutils::separate_cnj(&quot;id_lawsuit&quot;, remove = FALSE) %&gt;% glimpse() #&gt; Observations: 40 #&gt; Variables: 19 #&gt; $ file &lt;chr&gt; &quot;data-raw/cjsg/page1.html&quot;, &quot;data-raw/cjsg/pag... #&gt; $ id_page &lt;chr&gt; &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;... #&gt; $ id_decision &lt;chr&gt; &quot;11103571&quot;, &quot;11103186&quot;, &quot;11103116&quot;, &quot;11102507&quot;... #&gt; $ id_lawsuit &lt;chr&gt; &quot;2234431-52.2017.8.26.0000&quot;, &quot;2243740-97.2017.... #&gt; $ N &lt;chr&gt; &quot;2234431&quot;, &quot;2243740&quot;, &quot;0001328&quot;, &quot;0058527&quot;, &quot;0... #&gt; $ D &lt;chr&gt; &quot;52&quot;, &quot;97&quot;, &quot;12&quot;, &quot;52&quot;, &quot;22&quot;, &quot;50&quot;, &quot;23&quot;, &quot;50&quot;... #&gt; $ A &lt;chr&gt; &quot;2017&quot;, &quot;2017&quot;, &quot;2015&quot;, &quot;2017&quot;, &quot;2015&quot;, &quot;2013&quot;... #&gt; $ J &lt;chr&gt; &quot;8&quot;, &quot;8&quot;, &quot;8&quot;, &quot;8&quot;, &quot;8&quot;, &quot;8&quot;, &quot;8&quot;, &quot;8&quot;, &quot;8&quot;, &quot;... #&gt; $ T &lt;chr&gt; &quot;26&quot;, &quot;26&quot;, &quot;26&quot;, &quot;26&quot;, &quot;26&quot;, &quot;26&quot;, &quot;26&quot;, &quot;26&quot;... #&gt; $ O &lt;chr&gt; &quot;0000&quot;, &quot;0000&quot;, &quot;0366&quot;, &quot;0000&quot;, &quot;0572&quot;, &quot;0554&quot;... #&gt; $ class_subject &lt;chr&gt; &quot;Classe/Assunto:\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t Habea... #&gt; $ district &lt;chr&gt; &quot;São Paulo&quot;, &quot;Olímpia&quot;, &quot;Mongaguá&quot;, &quot;Pirajuí&quot;,... #&gt; $ court &lt;chr&gt; &quot;6ª Câmara de Direito Criminal&quot;, &quot;6ª Câmara de... #&gt; $ dt_decision &lt;chr&gt; &quot;11/01/2018&quot;, &quot;11/01/2018&quot;, &quot;14/12/2017&quot;, &quot;11/... #&gt; $ dt_publication &lt;chr&gt; &quot;12/01/2018&quot;, &quot;12/01/2018&quot;, &quot;12/01/2018&quot;, &quot;11/... #&gt; $ dt_registration &lt;chr&gt; &quot;12/01/2018&quot;, &quot;12/01/2018&quot;, &quot;12/01/2018&quot;, &quot;11/... #&gt; $ rapporteur &lt;chr&gt; &quot;Ricardo Tucunduva&quot;, &quot;Ricardo Tucunduva&quot;, &quot;Ama... #&gt; $ summary &lt;chr&gt; NA, NA, &quot;TRÁFICO DE DROGAS – recurso do minis... #&gt; $ txt_summary &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA... A função abjutils::calc_dig() calcula o dígito verificador do processo a partir do número incompleto. A função abjutils::check_dig() checa se o dígito do processo está correto. Essas funções são úteis para i) gerar números de processo aleatórios e ii) arrumar erros de parse, por exemplo, o resultado da leitura de um DJE ou de um PDF escaneado. abjutils::calc_dig(id_limpo_ndig) #&gt; [1] &quot;15&quot; abjutils::check_dig(id_montado) #&gt; [1] TRUE Finalmente, a função abjutils::sample_cnj() serve para criar amostras de números de processos. Esses pocessos podem ser manifestos ou não. Em algumas pesquisas mais complicadas (e.g. nossa pesquisa sobre processamento de homicídios) esse tipo de abordagem é necessária. set.seed(1) abjutils::sample_cnj(n = 10, foros = &quot;0001&quot;, anos = 2015:2017, orgao = &quot;8&quot;, tr = &quot;26&quot;, first_dig = 0, return_df = FALSE) %&gt;% abjutils::build_id() #&gt; [1] &quot;0205974-12.2015.8.26.0001&quot; &quot;0176556-92.2016.8.26.0001&quot; #&gt; [3] &quot;0687022-88.2016.8.26.0001&quot; &quot;0384103-68.2017.8.26.0001&quot; #&gt; [5] &quot;0769841-19.2015.8.26.0001&quot; &quot;0497699-30.2017.8.26.0001&quot; #&gt; [7] &quot;0717618-21.2017.8.26.0001&quot; &quot;0991906-87.2016.8.26.0001&quot; #&gt; [9] &quot;0380035-12.2016.8.26.0001&quot; &quot;0777445-31.2015.8.26.0001&quot; 3.10.2 Trabalhando com acentos A função abjutils::rm_accent() serve para tirar acentos de um texto abjutils::rm_accent(&quot;Têxto cóm açèntõs&quot;) #&gt; [1] &quot;Texto com acentos&quot; Só isso! Mas extremamente útil. Outra versão dessa função pode ser encontrada no pacote rslp. Para quem é desenvolvedor de pacotes, a função abjutils::escape_unicode() é muito útil: ela transforma todos os acentos em códigos do tipo \\uxxxx, permitindo que o pacote funcione em diferentes plataformas, sem os famosos problemas de encoding. Essa função não é para ser utilizada diretamente, mas sim como um addin do RStudio. "],
["wrap-up.html", "3.11 Wrap-up", " 3.11 Wrap-up Nessa aula, vimos Definição do pipe %&gt;% Um pouco sobre web scraping Usar o inspect! pacotes httr, xml2 e rvest Scrapers jurimétricos listar números com dje::download_dje() e esaj::download_cj*g(). coletar documentos com esaj::download_cpo*g(). processar documentos com esaj::run_parser(). Pacote abjutils Trabalhando com número CNJ Trabalhando com acentos: abjutils::rm_accent() Na próxima vez, vamos trabalhar as bases de dados obtidas, estudar expressões regulares e mais alguns pacotes do tidyverse. "],
["transformacao-de-dados-1.html", "Capítulo 4 Transformação de dados 1", " Capítulo 4 Transformação de dados 1 "],
["work-in-progress.html", "Capítulo 5 Work in progress", " Capítulo 5 Work in progress "],
["work-in-progress-1.html", "Capítulo 6 Work in progress", " Capítulo 6 Work in progress "],
["references.html", "References", " References "]
]
